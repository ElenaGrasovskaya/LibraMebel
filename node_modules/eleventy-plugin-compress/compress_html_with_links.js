"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("path"),r=require("./rip.js"),i=require("./read.js"),t=require("./gzip.js"),s=require("./write.js"),a=require("./brotli.js"),o=require("./deflate.js"),n=require("./is_relative.js"),l=require("./mkdir.js"),p=require("./pretty.js"),u=require("./constants.js");const c={gzip:t.gzip,brotli:a.brotli,deflate:o.deflate};exports.compressHTMLWithLinks=async(t,a,o,d)=>{const m="string"==typeof o?[o]:o,j=[Promise.resolve({data:t,url:a})].concat(r.rip(t,u.STYLESHEET_LINK_REGEXP).map((r=>i.read(e.join(n.isRelative(r)?e.dirname(a):d,r))))).concat(r.rip(t,u.SCRIPTS_LINK_REGEXP).map((r=>i.read(e.join(n.isRelative(r)?e.dirname(a):d,r)))));await Promise.all(m.map((e=>{const r=c[e];return Promise.all(j.map((e=>e.then((({data:e,url:i})=>{p.start(`Start to compress "${i}" file`),l.makeDirectories(i).then((()=>r(e,i))).then(s.write).then((()=>p.done(`"${i}" file was successfully compressed and written to disk`)),p.oops)})))))})))};
//# sourceMappingURL=compress_html_with_links.js.map
