{"version":3,"file":"url.js","sources":["../src/url.ts"],"sourcesContent":["import { existsSync } from 'fs';\nimport { dirname, sep, resolve, join } from 'path';\n\nimport { UP_LEVEL_GLOB, URL_DELIMITER } from './constants';\n\nconst isAbsolute = (url: string) => url.startsWith(URL_DELIMITER);\n\nexport const pathStats = (url: string) => {\n  const directories = dirname(url).split(sep);\n\n  return {\n    directories,\n    isAbsolute: isAbsolute(url),\n    isRelative: !isAbsolute(url),\n  };\n};\n\nexport const resolveFile = (\n  url: string,\n  inputDirectory: string,\n  relativeDirectory: string\n): string => {\n  const { isAbsolute } = pathStats(url);\n\n  return isAbsolute\n    ? resolve(inputDirectory, url.slice(1))\n    : existsSync(resolve(inputDirectory, url))\n    ? resolve(inputDirectory, url)\n    : resolve(relativeDirectory, url);\n};\n\nconst removeNameCollision = (url: string, directory: string) =>\n  url.startsWith(directory) ? url.replace(directory + URL_DELIMITER, '') : url;\n\nexport const buildOutputUrl = (\n  url: string,\n  publicDirectory: string\n): string => {\n  const { isAbsolute } = pathStats(url);\n\n  return (isAbsolute\n    ? join(publicDirectory, url.slice(1))\n    : url.startsWith(UP_LEVEL_GLOB)\n    ? join(\n        publicDirectory,\n        removeNameCollision(\n          url\n            .split(URL_DELIMITER)\n            .filter((part) => part !== UP_LEVEL_GLOB)\n            .join(URL_DELIMITER),\n          publicDirectory\n        )\n      )\n    : join(publicDirectory, url)\n  ).replace(/(sa|sc)ss$/, 'css');\n};\n"],"names":["isAbsolute","url","startsWith","URL_DELIMITER","pathStats","directories","dirname","split","sep","isRelative","publicDirectory","join","slice","UP_LEVEL_GLOB","directory","replace","removeNameCollision","filter","part","inputDirectory","relativeDirectory","resolve","existsSync"],"mappings":"sIAKA,MAAMA,EAAcC,GAAgBA,EAAIC,WAAWC,iBAEtCC,EAAaH,IAGjB,CACLI,YAHkBC,UAAQL,GAAKM,MAAMC,OAIrCR,WAAYA,EAAWC,GACvBQ,YAAaT,EAAWC,4BAqBE,CAC5BA,EACAS,KAEA,MAAMV,WAAEA,GAAeI,EAAUH,GAEjC,OAAQD,EACJW,OAAKD,EAAiBT,EAAIW,MAAM,IAChCX,EAAIC,WAAWW,iBACfF,OACED,EAboB,EAACT,EAAaa,IACxCb,EAAIC,WAAWY,GAAab,EAAIc,QAAQD,EAAYX,gBAAe,IAAMF,EAanEe,CACEf,EACGM,MAAMJ,iBACNc,QAAQC,GAASA,IAASL,kBAC1BF,KAAKR,iBACRO,IAGJC,OAAKD,EAAiBT,IACxBc,QAAQ,aAAc,gDArCC,CACzBd,EACAkB,EACAC,KAEA,MAAMpB,WAAEA,GAAeI,EAAUH,GAEjC,OAAOD,EACHqB,UAAQF,EAAgBlB,EAAIW,MAAM,IAClCU,aAAWD,UAAQF,EAAgBlB,IACnCoB,UAAQF,EAAgBlB,GACxBoB,UAAQD,EAAmBnB"}