{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import { join } from 'path';\n\nimport { bundle } from './bundle';\nimport { StylesPluginOptions } from './types';\nimport {\n  DEFAULT_SOURCE_DIRECTORY,\n  DEFAULT_STYLES_DIRECTORY,\n} from './constants';\n\n/**\n * Plugin that searches for links to stylesheets inside HTML,\n * compiles, normalizes and mificates them. After that - writes\n * to the _output_ directory.\n */\nexport const styles = (\n  config: Record<string, Function>,\n  {\n    sassOptions = {},\n    inputDirectory = join(DEFAULT_SOURCE_DIRECTORY, DEFAULT_STYLES_DIRECTORY),\n    cssnanoOptions = {},\n    addWatchTarget = true,\n    postcssPlugins = [],\n    purgeCSSOptions = {},\n    publicDirectory = '',\n  }: StylesPluginOptions = {}\n) => {\n  config.addTransform(\n    'styles',\n    async function (\n      this: Record<string, string>,\n      content: string,\n      outputPath: string\n    ) {\n      if (outputPath.endsWith('html')) {\n        return bundle(content, this.inputPath, outputPath, {\n          sassOptions,\n          inputDirectory,\n          cssnanoOptions,\n          postcssPlugins,\n          purgeCSSOptions,\n          publicDirectory,\n        });\n      }\n\n      return content;\n    }\n  );\n\n  if (addWatchTarget) {\n    config.addWatchTarget(inputDirectory);\n  }\n};\n\nexport { StylesPluginOptions };\n"],"names":["config","sassOptions","inputDirectory","join","DEFAULT_SOURCE_DIRECTORY","DEFAULT_STYLES_DIRECTORY","cssnanoOptions","addWatchTarget","postcssPlugins","purgeCSSOptions","publicDirectory","addTransform","async","content","outputPath","endsWith","bundle","this","inputPath"],"mappings":"8JAcsB,CACpBA,GAEEC,YAAAA,EAAc,GACdC,eAAAA,EAAiBC,OAAKC,2BAA0BC,4BAChDC,eAAAA,EAAiB,GACjBC,eAAAA,GAAiB,EACjBC,eAAAA,EAAiB,GACjBC,gBAAAA,EAAkB,GAClBC,gBAAAA,EAAkB,IACK,MAEzBV,EAAOW,aACL,UACAC,eAEEC,EACAC,GAEA,OAAIA,EAAWC,SAAS,QACfC,SAAOH,EAASI,KAAKC,UAAWJ,EAAY,CACjDb,YAAAA,EACAC,eAAAA,EACAI,eAAAA,EACAE,eAAAA,EACAC,gBAAAA,EACAC,gBAAAA,IAIGG,KAIPN,GACFP,EAAOO,eAAeL"}