"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("fs"),s=require("path"),t=require("./modules/@fluss/core/pipe.js");require("./modules/@fluss/core/stream.js");var i=require("./once_cached.js"),r=require("./pretty.js"),o=require("./build_public_url.js"),n=require("./constants.js");const a=i.onceCached((async(i,{manifest:a={},buildDirectory:c})=>{var u,l;const p=s.resolve(null!==(u=a.pathToManifest)&&void 0!==u?u:s.join(n.DEFAULT_SOURCE_DIRECTORY,n.DEFAULT_MANIFEST_NAME)),d=s.basename(p),f=s.resolve(c,null!==(l=a.publicDirectory)&&void 0!==l?l:"",d);return await(async({icons:s,pathToManifest:t,pathToOutputManifest:i})=>e.promises.readFile(t,{encoding:"utf-8"}).then(JSON.parse).then((e=>Object.assign(Object.assign({},e),{icons:(e.icons||[]).concat(s)}))).then(JSON.stringify).then((s=>e.promises.writeFile(i,s,{encoding:"utf-8"}))))({pathToManifest:p,icons:i,pathToOutputManifest:f}).catch(r.oops),r.done("Manifest was successfully updated and moved to build directory"),t.pipe(o.buildPublicUrl,o.makeUrlFromRoot)(a.publicDirectory,d)}));exports.handleManifest=a;
//# sourceMappingURL=update_manifest.js.map
