{"version":3,"file":"stream.js","sources":["../../../../node_modules/@fluss/core/stream.js"],"sourcesContent":["import{isJust as e}from\"./is_just_nothing.js\";import{isObject as s}from\"./is_object.js\";import{isFunction as r}from\"./is_function.js\";var t;!function(e){e.FREEZE=\"freeze\",e.RESUME=\"resume\",e.DESTROY=\"destroy\"}(t||(t={}));const n=\"Stream\",i=(s={_isActive:!0,_valueListeners:[],_destroyListeners:[],_freezeListeners:[],_resumeListeners:[]})=>{const r=e=>s._isActive?(s._valueListeners.push(e),()=>{s._valueListeners=s._valueListeners.filter((s=>s!==e))}):()=>{},n=e=>{const s=i();return s.on(t.DESTROY,r(e(s))),s};return{on:(e,r)=>{if(s._isActive)switch(e){case t.FREEZE:return s._freezeListeners.push(r),()=>{s._freezeListeners=s._freezeListeners.filter((e=>e!==r))};case t.RESUME:return s._resumeListeners.push(r),()=>{s._resumeListeners=s._resumeListeners.filter((e=>e!==r))};case t.DESTROY:return s._destroyListeners.push(r),()=>{s._destroyListeners=s._destroyListeners.filter((e=>e!==r))};default:return()=>{}}return()=>{}},map:e=>n((s=>r=>s.send(e(r)))),send:e=>(s._isActive&&s._valueListeners.forEach((s=>s(e))),i(s)),filter:e=>n((s=>r=>{e(r)&&s.send(r)})),uniqueBy:e=>{const s=new Set;return n((r=>t=>{const n=e(t);s.has(n)||(s.add(n),r.send(t))}))},compress:()=>n((s=>r=>{e(r)&&s.send(r)})),concat:e=>{const s=i();return s.on(t.DESTROY,r(s.send)),s.on(t.DESTROY,e.listen(s.send)),s},freeze:()=>(s._freezeListeners.forEach((e=>e())),s._isActive=!1,i(s)),resume:()=>(s._isActive=!0,s._resumeListeners.forEach((e=>e())),i(s)),destroy:()=>(s._destroyListeners.forEach((e=>e())),s._isActive=!1,s._valueListeners=[],s._freezeListeners=[],s._resumeListeners=[],s._destroyListeners=[],i(s)),derive:n,listen:r,type:()=>\"Stream\"}},o=()=>i(),_=e=>s(e)&&r(e.type)&&\"Stream\"===e.type();export{n as STREAM_OBJECT_TYPE,t as StreamEvent,_ as isStream,o as stream};\n//# sourceMappingURL=stream.js.map\n"],"names":["e","t","FREEZE","RESUME","DESTROY"],"mappings":"aAA6I,IAASA,yDAAZC,4BAAYD,EAA4DC,sBAAIA,oBAAE,KAA7DC,OAAO,SAASF,EAAEG,OAAO,SAASH,EAAEI,QAAQ"}