{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import { join } from 'path';\n\nimport { bundle } from './bundle';\nimport { ScriptsPluginOptions } from './types';\nimport {\n  DEFAULT_SOURCE_DIRECTORY,\n  DEFAULT_SCRIPTS_DIRECTORY,\n} from './constants';\n\n/**\n * Plugin that searches for links to scripts inside HTML,\n * compiles and minifies them. After that - writes\n * to the _output_ directory.\n */\nexport const scripts = (\n  config: Record<string, Function>,\n  {\n    inputDirectory = join(DEFAULT_SOURCE_DIRECTORY, DEFAULT_SCRIPTS_DIRECTORY),\n    esbuildOptions = {},\n    publicDirectory = '',\n    addWatchTarget = true,\n  }: ScriptsPluginOptions = {}\n) => {\n  config.addTransform('scripts', async (content: string, outputPath: string) =>\n    outputPath.endsWith('html')\n      ? bundle(content, outputPath, {\n          inputDirectory,\n          publicDirectory,\n          esbuildOptions,\n        })\n      : content\n  );\n\n  if (addWatchTarget) {\n    config.addWatchTarget(inputDirectory);\n  }\n};\n\nexport { ScriptsPluginOptions };\n"],"names":["config","inputDirectory","join","DEFAULT_SOURCE_DIRECTORY","DEFAULT_SCRIPTS_DIRECTORY","esbuildOptions","publicDirectory","addWatchTarget","addTransform","async","content","outputPath","endsWith","bundle"],"mappings":"+JAcuB,CACrBA,GAEEC,eAAAA,EAAiBC,OAAKC,2BAA0BC,6BAChDC,eAAAA,EAAiB,GACjBC,gBAAAA,EAAkB,GAClBC,eAAAA,GAAiB,GACO,MAE1BP,EAAOQ,aAAa,WAAWC,MAAOC,EAAiBC,IACrDA,EAAWC,SAAS,QAChBC,SAAOH,EAASC,EAAY,CAC1BV,eAAAA,EACAK,gBAAAA,EACAD,eAAAA,IAEFK,IAGFH,GACFP,EAAOO,eAAeN"}